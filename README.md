View here: https://gist.github.com/BetrixDev/2086e54640e74e71bdcf857d614b12a5

_WARNING_ Contains ugly code
